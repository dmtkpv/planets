!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.PlanetarySystem=e():t.PlanetarySystem=e()}(self,(function(){return(()=>{"use strict";var t={d:(e,s)=>{for(var i in s)t.o(s,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:s[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{default:()=>p});const s={getHeight(t,{perspective:e,angle:s}){const i=-s*Math.PI/180;return t-t/2-(t-t*Math.cos(i)-t/2)*e/(e-t*Math.sin(i))},createElement(t){const e=document.createElement("div");return e.className=t,e},clone:t=>JSON.parse(JSON.stringify(t))},i={angle:0,diameter:0,orbits:[]};function a(t){const e=getComputedStyle(t).getPropertyValue("transform");if(!e)return 0;const s=e.split("(")[1].split(")")[0].split(",");let i=Math.atan2(s[1],s[0]);return i<0&&(i+=2*Math.PI),180*i/Math.PI}function o(t){let e=0;for(;t;)t instanceof h&&(e-=t.angle),t instanceof d&&(e-=a(t.$bodiesEl)),t=t.parentOrbit||t.parentPoint;return e}function n(t){let e=[];for(;t;)t.animationDuration&&e.push(t.animationDuration),t=t.parentPoint&&t.parentPoint.parentOrbit;return e.length?1/e.reduce(((t,e)=>t+1/e),0):0}function r(t){t.$body.style.animation="none",t.$body.offsetHeight,t.$body.style.animation="",t.$body.style.setProperty("--angle",o(t)+"deg"),t.$body.style.setProperty("--duration",n(t.parentOrbit)+"s")}class h{constructor(t,e,a,h){Object.assign(this,i,t);const l=s.createElement(`ps-point ps-level-${h}`);l.style.setProperty("--angle",this.angle+"deg"),l.style.setProperty("--translate",e.diameter/2+"px"),this.$bodiesEl=l,this.$orbitsEl=l.cloneNode(),this.parentOrbit=e,this.orbits=this.orbits.map((t=>new d(t,this,a,h+1))),t.body&&(this.$body=s.createElement("ps-body"),this.$body.style.width=this.$body.style.height=t.body.size+"px",this.$body.innerHTML=a.renderBody(t.body),this.$body.style.setProperty("--duration",n(e)+"s"),this.$body.style.setProperty("--angle",o(this)+"deg"),a.on("pause:orbit",(t=>r(this))),a.on("play:orbit",(t=>r(this))))}move(t=this.parentOrbit.diameter/2){this.$bodiesEl.style.setProperty("--translate",t+"px"),this.$orbitsEl.style.setProperty("--translate",t+"px")}update(){this.$bodiesEl.style.setProperty("--translate",this.parentOrbit.diameter/2+"px"),this.$orbitsEl.style.setProperty("--translate",this.parentOrbit.diameter/2+"px")}}const l={diameter:0,animationDuration:0,points:[]};class d{constructor(t,e,i,a){Object.assign(this,l,t);const o=s.createElement(`ps-orbit ps-level-${a}`);o.style.width=this.diameter+"px",o.style.height=this.diameter+"px",o.style.animationDuration=this.animationDuration+"s",this.level=a,this.system=i,this.config={...t},this.$bodiesEl=o,this.$orbitsEl=o.cloneNode(),this.parentPoint=e,this.points=this.points.map((t=>new h(t,this,i,a)))}setDiameter(t){this.diameter=t,this.$bodiesEl.style.width=this.$orbitsEl.style.width=this.diameter+"px",this.$bodiesEl.style.height=this.$orbitsEl.style.height=this.diameter+"px"}pause(){this.$bodiesEl.style.animationPlayState="paused",this.$orbitsEl.style.animationPlayState="paused",this.animationDuration=0,this.system.emit("pause:orbit",this)}play(){this.$bodiesEl.style.animationPlayState="",this.$orbitsEl.style.animationPlayState="",this.animationDuration=this.config.animationDuration,this.system.emit("play:orbit",this)}}class p{constructor(t,{camera:e,canvas:i,renderBody:a,orbits:o}){function n(t,e){t.appendChild(e.$orbitsEl),e.points.forEach((t=>{e.$orbitsEl.appendChild(t.$orbitsEl),t.orbits.forEach((e=>n(t.$orbitsEl,e)))}))}function r(t,e){t.appendChild(e.$bodiesEl),e.points.forEach((t=>{t.$body&&t.$bodiesEl.appendChild(t.$body),e.$bodiesEl.appendChild(t.$bodiesEl),t.orbits.forEach((e=>r(t.$bodiesEl,e)))}))}this.events={},this.camera=e,this.renderBody=a,this.zoom={},this.zoom.max=1,this.zoom.min=1,this.zoom.scale=1,this.zoom.value=1,this.translate={},this.translate.x=0,this.translate.y=0,this.width={},this.width.max=i.maxWidth,this.width.min=i.minWidth,this.height={},this.height.max=s.getHeight(this.width.max,e),this.$scene=t,this.$scene.classList.add("ps-scene"),this.$scene.style.width=this.width.max+"px",this.$scene.style.height=this.height.max+"px",this.$scene.style.setProperty("--camera-angle",this.camera.angle+"deg"),this.$orbits=s.createElement("ps-canvas ps-canvas--orbits"),this.$orbits.style.transform=`perspective(${e.perspective}px) translateY(50%) rotateX(${e.angle}deg) translateY(-50%)`,this.$scene.appendChild(this.$orbits),this.$bodies=s.createElement("ps-canvas ps-canvas--bodies"),this.$bodies.style.transform=`perspective(${e.perspective}px) translateY(50%) rotateX(${e.angle}deg) translateY(-50%)`,this.$scene.appendChild(this.$bodies),this.orbits=o.map((t=>new d(t,null,this,0))),this.orbits.forEach((t=>{n(this.$orbits,t),r(this.$bodies,t)})),this.resize()}resize(){const t=this.$scene.parentNode.offsetWidth/this.width.max,e=this.$scene.parentNode.offsetHeight/this.height.max;this.zoom.min=Math.min(t,e,1),this.zoom.min=Math.max(this.zoom.min,this.width.min/this.width.max),this.zoomTo(100)}zoomTo(t){t=Math.max(t,100),t=Math.min(t,100*this.zoom.max/this.zoom.min),this.zoom.value=t,this.zoom.scale=t*this.zoom.min/100,this.translate.x=(this.$scene.parentNode.offsetWidth-this.width.max*this.zoom.scale)/2,this.translate.y=(this.$scene.parentNode.offsetHeight-this.height.max*this.zoom.scale)/2,this.$scene.style.transform=`translate(${this.translate.x}px, ${this.translate.y}px) scale(${this.zoom.scale})`,this.emit("zoom",t)}translateTo(t,e){this.translate.x=t,this.translate.y=e,this.$scene.style.transform=`translate(${this.translate.x}px, ${this.translate.y}px) scale(${this.zoom.scale})`,this.emit("translate",this.translate)}on(t,e){this.events[t]=this.events[t]||[],this.events[t].push(e)}off(t,e){if(!this.events[t])return;const s=this.events[t].indexOf(e);s>-1&&this.events[t].splice(s,1)}emit(t,e){this.events[t]&&this.events[t].forEach((t=>t(e)))}}return e.default})()}));
//# sourceMappingURL=planetary-system.js.map