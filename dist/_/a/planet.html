<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>

        body {
            margin: 0;

        }
        /*header {*/
        /*    position: relative;*/
        /*    height: 200px;*/
        /*    border-radius: 0 0 150px 150px;*/
        /*    background: #FFFFFF;*/
        /*    z-index: 1;*/
        /*}*/


        .root {
            position: relative;
            width: 100%;
            height: 80vh;
            background: #222;
            overflow: hidden;
            perspective: 500px;
        }

        .system {
            width: 100%;
            height: 100%;
            transform: rotateX(60deg) translateY(-50%);
            transform-style: preserve-3d;
        }

        .orbit {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate3d(-50%, -50%, 0);
            border: 2px dashed #000;
        }
        .orbit.o1 {
            width: 0;
            height: 0;
        }
        .orbit.o1 {
            width: 30%;
            height: 30%;
        }
        .orbit.o3 {
            width: 70%;
            height: 70%;
        }
        .orbit.o4 {
            width: 100%;
            height: 100%;
        }

        .planet {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 30px;
            height: 30px;
            margin: -15px 0 0 -15px;
            background: #F00;
            /*transform: rotateX(-60deg);*/
            animation: planet 5s linear infinite;
        }

        @keyframes planet {
            0% {
                transform: rotateX(-60deg) rotateZ(0deg) translate(100px);
            }
            100% {
                transform: rotateX(-60deg) rotateZ(360deg) translate(100px);
            }
        }

        .test {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #F00;
            perspective: 500px;
            margin-top: -20%;
        }
        .test2 {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transform: rotateX(90deg);
            transform-origin: 0 100%;
            background: #CCC;
            opacity: 0.5;
        }

    </style>
</head>
<body>

    <header></header>

    <div class="root">
        <div class="test">
            <div class="test2">
                <div class="orbit o1"></div>
            </div>
        </div>


<!--        <div class="system">-->
<!--            <div class="orbit o1">-->
<!--                <div class="planet"></div>-->
<!--            </div>-->
<!--            <div class="orbit o2"></div>-->
<!--            <div class="orbit o3"></div>-->
<!--            <div class="orbit o4"></div>-->
<!--        </div>-->


<!--        <div class="orbit">-->
<!--            <div></div>-->

<!--            <div class="planet"></div>-->
<!--        </div>-->
    </div>

    <script>




        function getValue ($node, property) {
            return parseFloat(getComputedStyle($node).getPropertyValue(property));
        }

        const $test = document.querySelector('.test');
        const $test2 = document.querySelector('.test2');
        const $root = document.querySelector('.root');
        // const perspective = 500;
        // const angle = 90;


        function calc(oldx, angle, p) {
            var x = Math.cos(angle) * oldx;
            var z = Math.sin(angle) * oldx;

            return x * p / (p+z);
        }

        function resize () {
            const w = $root.offsetWidth;
            const h = $root.offsetHeight;
            const s = Math.min(w, h);
            $test.style.width = s + 'px';
            $test.style.height = s + 'px';

            //
            // const x = 0;
            // const y = w;
            // const z = 0;
            // const a = Math.PI / 3;
            //
            //
            //
            //
            // const x1 = x * Math.cos(a) - y * Math.sin(a);
            // const y1 = x * Math.sin(a) - y * Math.cos(a);
            // const z1 = z;
            //
            // console.log(x1, y1, z1)


            // const x =

            // |cos θ   −sin θ   0| |x|   |x cos θ − y sin θ|   |x'|
            // |sin θ    cos θ   0| |y| = |x sin θ + y cos θ| = |y'|
            // |  0       0      1| |z|   |        z        |   |z'|



            // const width = $root.offsetWidth;
            // const perspective = 500;
            // const angle = 60;
            //
            //
            // var A = 0;
            // var B = width;
            // // new coordinates
            // A = calc(A, angle*Math.PI/180, perspective);
            // B = calc(B, angle*Math.PI/180, perspective);
            //
            // console.log(A);
            // console.log(B);
            //
            // // translate back
            // A += width/2;
            // B += width/2;
            // if(B < A) { var tmp = A; A = B; B = tmp; } // swap
            // var realHeight = B-A;
            //
            // console.log(realHeight)
            //
            // // $('#fake').css({
            // //     'height': realHeight,
            // //     'margin-top': 200 - realHeight
            // // });
            // //
            // //
            // //
            //
            // // console.log(s * (500 / (500 + s)))

        }

        resize();
        window.addEventListener('resize', resize);

        //
        // |1     0           0| |x|   |        x        |   |x'|
        // |0   cos θ    −sin θ| |y| = |y cos θ − z sin θ| = |y'|
        // |0   sin θ     cos θ| |z|   |y sin θ + z cos θ|   |z'|

        // Transformed Width = width * ( perspective / ( perspective - ( -translateZ ) )



    </script>

</body>
</html>