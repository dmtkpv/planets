<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>LS Solar System</title>
    <link rel="stylesheet" href="../planetary-system.css">
    <script src="../planetary-system.js"></script>
    <script src="config.js"></script>



    <!--
        Global styles
    -->

    <style>
        * {
            box-sizing: border-box;
        }
        body {
            margin: 0;
            font-family: Arial, sans-serif;
        }
        section {
            height: 80vh;
            position: relative;
            overflow: hidden;
            background: #F1F7FF;
        }
        .planetary-system {
            /*background: #222;*/
        }
        .planetary-camera {
            /*border: 4px dashed #F00;*/
        }
        .planetary-body {
            /*background: rgba(255,0,0,1);*/
        }
        .planetary-body * {
            /*background: rgba(255,0,0,1);*/
        }

        .planetary-orbit {
            border: 3px dashed #8FC2FF;
        }



        .object img {
            width: 100%;
        }
        .object p {
            text-align: center;
            background: #D2E5FF;
            color: #0A69D2;
            border: 2px solid #FFF;
            display: inline-block;
            padding: 10px;
            position: relative;
            left: 50%;
            transform: translateX(-50%);
        }

        .planetary-object .planetary-orbit {
            opacity: 0;
            transition: opacity .3s ease;
        }
        .planetary-object.hovered .planetary-orbit,
        .planetary-object.active .planetary-orbit {
            opacity: 1;
        }

        .planetary-object {
            transition: transform 1s;
        }



    </style>

</head>
<body>



<!--
    Solar system
-->

<section>
    <div id="system"></div>

    <div id="system2">

        <!--

        object.translateTo(0)
        object.translateTo(ring.radius)

        from: object.style.transform = `rotate(angle) translateX(radius)`
          to: object.style.transform = `rotate(angle) translateX(0)`
        -->

        <div class="camera">

            <div class="spin">
                <div class="object">
                    <div class="body"></div>
                </div>
            </div>

            <div class="spin"> <!-- rotation animation, radius -->
                <div class="object"> <!-- angle, translateX = radius -->
                    <div class="spin">
                        <div class="object"></div>
                    </div>
                    <div class="spin"> <!-- rotation animation, radius -->
                        <div class="object"></div>
                        <div class="object"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="camera">
            <div class="ring">
                <div class="ring"></div>
                <div class="ring"></div>
            </div>
        </div>



    </div>



</section>



<!--
    Zoom control
-->

<div id="zoom">
    <button>+</button>
    <input disabled>
    <button>-</button>
</div>


<script>



    // --------------------
    // Config
    // --------------------

    const system = new PlanetarySystem('#system', planetaryConfig);


    const sun = system.orbits[0].objects[0];
    let active = null;


    system.orbits.forEach(orbit => {

        orbit.objects.forEach(object => {


            object.$body.addEventListener('mouseenter', () => {
                if (object === sun) return;
                system.orbits.forEach(orbit => orbit.pause());
                object.$el.classList.add('hovered');
            })

            object.$body.addEventListener('mouseleave', () => {
                if (object === sun) return;
                system.orbits.forEach(orbit => orbit.play());
                object.$el.classList.remove('hovered');
            })

            object.$body.addEventListener('click', () => {

                if (object === sun && !active) return;

                if (object === sun) {
                    sun.$el.style.transform = `rotateZ(${object.angle}deg) translateX(0px)`;
                    active.$el.classList.remove('active');
                    active.$el.style.transform = `rotateZ(${active.angle}deg) translateX(${active.parentOrbit.diameter / 2}px)`;
                    active = null;
                    return
                }


                if (active) {
                    active.$el.classList.remove('active');
                    active.$el.style.transform = `rotateZ(${active.angle}deg) translateX(${active.parentOrbit.diameter / 2}px)`;
                }
                if (active !== object) {
                    active = object;
                    object.$el.classList.add('active');
                    object.$el.style.transform = `rotateZ(${object.angle}deg) translateX(0)`;
                    sun.$el.style.transform = `rotateZ(${sun.angle}deg) translateX(${1200}px)`;
                }
                else {
                    sun.$el.style.transform = `rotateZ(${sun.angle}deg) translateX(${0}px)`;
                }


                //
                // if (active) {
                //     active.$el.classList.remove('active');
                //     active.$el.style.transform = `rotateZ(${active.angle}deg) translateX(${active.parentOrbit.diameter / 2}px)`;
                // }
                // if (active === object) {
                //     active = null;
                // }
                // else {
                //     active = object;
                //     object.$el.classList.add('active');
                //     object.$el.style.transform = `rotateZ(${object.angle}deg) translateX(0)`;
                // }
                // if (active) {
                //     sun.$el.style.transform = `rotateZ(${object.angle}deg) translateX(${1200}px)`;
                // }
                //

                //
                // if (object.$el.classList.contains('active')) {
                //     object.$el.style.transform = `rotateZ(${object.angle}deg) translateX(${object.parentOrbit.diameter / 2}px)`;
                // }
                // else {
                //     object.$el.style.transform = `rotateZ(${object.angle}deg) translateX(0)`;
                // }
                // object.$el.classList.toggle('active');
            })

        })

    })







    // --------------------
    // Zoom
    // --------------------

    const $zoomVal = document.querySelector('#zoom input');
    const $zoomIn = document.querySelector('#zoom button:first-child');
    const $zoomOut = document.querySelector('#zoom button:last-child');

    system.on('zoom', () => {
        $zoomVal.value = Math.round(system.zoom.value);
    })

    $zoomIn.addEventListener('click', () => {
        system.setZoom(system.zoom.value + 1);
    });

    $zoomOut.addEventListener('click', () => {
        system.setZoom(system.zoom.value - 1);
    });



    // --------------------
    // Hover
    // --------------------

    // system.on('zoom', () => {
    //     $zoomVal.value = Math.round(system.zoom.value);
    // })





    // --------------------
    // Resize
    // --------------------

    window.addEventListener('resize', () => {
        system.resize();
    });

    system.resize();

</script>


</body>
</html>